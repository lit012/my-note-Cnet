### 查询路由表确定输出端口

包送到路由器端口后，MAC头部的任务完成，此时路由器就丢弃了MAC头部。

![tip](img/image40.png)

接下来路由器根据路由表和IP头部的IP地址进行包转发操作，如下：

![路由表](img/image20.png)

假设一台计算机要向地址为192.168.1.10的服务器发送网络包，路由器会在路由表中查询该地址网络号对应的记录，也就是在路由表中匹配网路号192.168.1的记录，最终匹配到三四五行。

接下来路由器会按照最长匹配的原则找到网络号最长的那一条记录，也就是第四行。网络号越长，代表该子网下服务器的数量越少。

有时会出现路由器或网线故障而采用备用路由器的情况，这时就可能出现多条相同长度的记录，需要通过跃点计数找到最近的路由器把网络包传过去。

在规模庞大的互联网中，路由器在路由表中查不到目的地，就会丢弃发送包（<font size=2><i>交换机因为规模小会发给所有连接的设备</i></font>），然后通过ICMP消息告知发送方。